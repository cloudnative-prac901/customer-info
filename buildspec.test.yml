version: 0.2
phases:
  pre_build:
    commands:
      - pip install -r requirements.txt
      - pip install pytest
      - export PYTHONPATH="${CODEBUILD_SRC_DIR}:${CODEBUILD_SRC_DIR}/app:${PYTHONPATH}"
      - export DB_CREDENTIALS_JSON='{"username":"test_user","password":"test_pass","port":3306}'
  build:
    commands:
      - pytest -q --junitxml=test-results/junit.xml
reports:
  pytest_reports:
    files: [test-results/junit.xml]
    file-format: JUNITXML
